---
title: GCC
date: 2016-09-06 00:37:51
tags:
    -gcc
    -linux
---

# GCC程序编译

> Linux系统下的gcc（GUN C Compiler）是GUN推出的功能强大、性能优越的多平台编译器，是GUN代表作之一。gcc可以在多种硬件平台上编译出可执行程序，其执行效率与一般的编译器相比平均效率要高20%-30%。
> gcc又是一个交叉平台编译器，它能够在当前CPU平台上为多种不同体系结构的硬件平台开发软件，因此尤其适合在嵌入式领域的开发编译。

## GCC编译过程

### 1. 预处理(Pre-Processing)

 > 在该阶段，对包含的头文件（#include）和宏定义（#define、#ifdef等）进行处理 。可以使用gcc的选项“-E” 让gcc在预处理结束后停止编译过程。

### 2. 编译(Compiling)

> 接下来进行的是编译阶段，在这个阶段中，gcc首先要检查代码的规范性、是否有语法错误等，以确定代码的实际要做的工作，在检查无误后，gcc把代码翻译成汇编语言。用户可以使用“-S”选项来进行查看，该选项只进行编译而不进行汇编，生成汇编代码。

### 3. 汇编(Assembling)

> 汇编阶段把编译阶段生成的汇编程序.s转成目标文件.o，使用-c选项，可以把汇编程序转换成二进制目标代码。

### 4. 链接(Linking)

 > 把目标代码链接起来，转换成为可执行文件。

## GCC基本用法

> gcc g++用法类似，下面以gcc为例

### 语法

gcc  [选项]  要编译的文件  [选项]  [目标文件]

### 实例演示

:test.c
```shell
#include <stdio.h>

#define NAME "zheng"

int main(){

	printf("hello %s\n", NAME);
	return 0;

}
```
编译和运行程序：
```
$ gcc test.c -o test
$ ./test
```
输出：hello zheng

### test.c经历的编译过程
**gcc --预处理**
```
$ gcc -E test.c -o test.i
```
**gcc --编译阶段**
```
$ gcc -S test.i -o test.s
```
**gcc --汇编阶段**
```
$ gcc -c test.s -o test.o
```
**gcc—链接阶段**
```
$ gcc test.o -o test
```

### 常用编译选项

 1. -o output_filename：确定可执行文件的名称为output_filename，如果不给出该选项，gcc会给出预设的可执行文件a.out
 2. -c：只编译，不连接成可执行文件，编译器只是由输入的.c等源代码文件-生成.o为后缀的目标文件。
 4. -S：生成一个后缀为.s的汇编文件
 5. -E：对源代码只进行预处理
 6. -g：产生调试工具所必须的符号信息，要相对编译的程序进行调试，就必须加入这个选项。
 7. -O：对程序进行优化编译、链接，采用这个选项，整个源代码会在编译、链接过程中进行优化处理，这样产生的可执行文件的执行效率可以提高，但是，编译、链接的速度就相应的要慢一些。
 8. -O2：比-O更好的优化编译、链接，当然整个编译、链接过程会更慢。
